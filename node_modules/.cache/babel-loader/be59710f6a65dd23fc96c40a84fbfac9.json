{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Fabi\\\\Documents\\\\app\\\\src\\\\components\\\\MapSidebar.tsx\";\nimport React, { useState } from 'react';\nimport 'ol/ol.css';\nimport Sidebar from './Sidebar';\nimport Tab from './Tab';\nimport ToggleButton from './ToogleButton';\nimport TabContent from './TabContent';\nimport { Feature } from 'ol';\nimport { activeToggleColor } from '../utils/MapStyles';\nimport Button from './Button';\nimport { geoserverWfsUrl, transactionParameters, wfsTransaction, geoserverHeaders } from '../utils/MapConfig';\nconst mapListeners = [];\n\nconst MapSidebar = props => {\n  const {\n    map\n  } = props;\n  const [collapsed, setCollapsed] = useState(true);\n  const [selected, setSelected] = useState(undefined);\n  const [toggleValue, setToggleValue] = useState(false);\n  const [selectedFeature, setSelectedFeature] = useState(new Feature());\n\n  function onClose() {\n    setCollapsed(true); //@ts-ignore\n\n    setSelected(undefined);\n  }\n\n  function onOpen(id) {\n    setCollapsed(false); //@ts-ignore\n\n    setSelected(id);\n  }\n\n  ;\n\n  function onToggleChange() {\n    setToggleValue(!toggleValue);\n    selectedFeature.set('visited', !toggleValue);\n  }\n\n  const saveData = feature => {\n    if (feature) {\n      let xmlString = new XMLSerializer().serializeToString(wfsTransaction.writeTransaction([], [feature], [], transactionParameters));\n      fetch(geoserverWfsUrl, {\n        method: 'POST',\n        mode: 'no-cors',\n        headers: geoserverHeaders,\n        body: xmlString\n      }).then(response => console.log('Feature successfully modified.')).catch(error => console.log(error + 'Feature was not modified.'));\n    } else {\n      console.log('Error');\n    }\n  };\n\n  let prevSelected = [];\n\n  if (map) {\n    if (mapListeners.length === 0) {\n      const mapListener = map.on('click', function (e) {\n        map.forEachFeatureAtPixel(e.pixel, feature => {\n          let castedFeature = feature;\n          prevSelected.unshift(castedFeature);\n          setSelectedFeature(prevSelected[0]);\n          prevSelected[0].set('selected', true);\n\n          if (prevSelected.length > 1) {\n            prevSelected[1].set('selected', false);\n          }\n\n          prevSelected.splice(1);\n        });\n      });\n      mapListeners.push(mapListener);\n    }\n  }\n\n  return React.createElement(React.Fragment, null, React.createElement(Sidebar, {\n    id: \"sidebar\",\n    collapsed: collapsed,\n    selected: selected,\n    onClose: onClose //@ts-ignore\n    ,\n    doOpen: onOpen,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, React.createElement(Tab, {\n    id: \"home\",\n    header: \"Home\",\n    faIcon: \"fa fa-bars\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, React.createElement(TabContent, {\n    content: React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \"This is Home.\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  })), React.createElement(Tab, {\n    id: \"database\",\n    header: \"Database\",\n    faIcon: \"fa fa-database\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }), React.createElement(Tab, {\n    id: \"locations\",\n    header: \"Set visited locations\",\n    faIcon: \"fa fa-mouse-pointer\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, React.createElement(TabContent, {\n    content: React.createElement(React.Fragment, null, React.createElement(ToggleButton, {\n      id: \"toggleVisited\",\n      isOn: selectedFeature.get('visited'),\n      isOnColor: activeToggleColor,\n      handleToggle: onToggleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }), JSON.stringify(selectedFeature.get('visited')), React.createElement(Button, {\n      buttonText: \"Update\",\n      response: \"test\",\n      clickButton: saveData,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  })), React.createElement(Tab, {\n    id: \"tracking\",\n    header: \"Tracking\",\n    faIcon: \"fa fa-map\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  }, React.createElement(TabContent, {\n    content: React.createElement(React.Fragment, null, React.createElement(Button, {\n      buttonText: \"Start tracking\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }), React.createElement(Button, {\n      buttonText: \"Quit tracking\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  })), React.createElement(Tab, {\n    id: \"settings\",\n    header: \"Settings\",\n    faIcon: \"fa fa-cogs\",\n    disabled: true,\n    anchor: \"bottom\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }), React.createElement(Tab, {\n    id: \"off\",\n    header: \"PowerOff\",\n    faIcon: \"fa fa-power-off\",\n    anchor: \"bottom\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  })));\n};\n\nexport default MapSidebar;","map":{"version":3,"sources":["C:/Users/Fabi/Documents/app/src/components/MapSidebar.tsx"],"names":["React","useState","Sidebar","Tab","ToggleButton","TabContent","Feature","activeToggleColor","Button","geoserverWfsUrl","transactionParameters","wfsTransaction","geoserverHeaders","mapListeners","MapSidebar","props","map","collapsed","setCollapsed","selected","setSelected","undefined","toggleValue","setToggleValue","selectedFeature","setSelectedFeature","onClose","onOpen","id","onToggleChange","set","saveData","feature","xmlString","XMLSerializer","serializeToString","writeTransaction","fetch","method","mode","headers","body","then","response","console","log","catch","error","prevSelected","length","mapListener","on","e","forEachFeatureAtPixel","pixel","castedFeature","unshift","splice","push","get","JSON","stringify"],"mappings":"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","sourcesContent":["\r\nimport React, { useState } from 'react';\r\nimport 'ol/ol.css';\r\nimport { IMapSidebarProps } from '../types/types';\r\nimport Sidebar from './Sidebar';\r\nimport Tab from './Tab';\r\nimport ToggleButton from './ToogleButton';\r\nimport TabContent from './TabContent';\r\nimport { Feature, MapBrowserEvent } from 'ol';\r\nimport { FeatureLike } from 'ol/Feature';\r\nimport { activeToggleColor } from '../utils/MapStyles';\r\nimport Button from './Button';\r\nimport { geoserverWfsUrl, transactionParameters, wfsTransaction, geoserverHeaders } from '../utils/MapConfig';\r\n\r\nconst mapListeners = [];\r\n\r\nconst MapSidebar = (props: IMapSidebarProps): JSX.Element => {\r\n\r\n    const { map } = props;\r\n\r\n    const [collapsed, setCollapsed] = useState(true);\r\n    const [selected, setSelected] = useState(undefined);\r\n    const [toggleValue, setToggleValue] = useState(false);\r\n    const [selectedFeature, setSelectedFeature] = useState(new Feature())\r\n\r\n    function onClose() {\r\n        setCollapsed(true);\r\n        //@ts-ignore\r\n        setSelected(undefined);\r\n    }\r\n    function onOpen(id: string) {\r\n        setCollapsed(false)\r\n        //@ts-ignore\r\n        setSelected(id)\r\n    };\r\n\r\n    function onToggleChange() {\r\n        setToggleValue(!toggleValue)\r\n        selectedFeature.set('visited', !toggleValue)\r\n    }\r\n\r\n    const saveData = (feature: Feature) => {\r\n        if (feature) {\r\n            \r\n            let xmlString = new XMLSerializer().serializeToString(\r\n                wfsTransaction.writeTransaction([], [feature], [], transactionParameters)\r\n            )\r\n            fetch(geoserverWfsUrl, {\r\n                method: 'POST',\r\n                mode: 'no-cors',\r\n                headers: geoserverHeaders,\r\n                body: xmlString\r\n            })\r\n                .then(response => console.log('Feature successfully modified.'))\r\n                .catch(error => console.log(error + 'Feature was not modified.'));\r\n        }\r\n        else {\r\n            console.log('Error');\r\n        }\r\n    }\r\n\r\n    let prevSelected: Feature[] = []\r\n\r\n    if (map) {\r\n        if (mapListeners.length === 0) {\r\n            const mapListener = map.on('click', function (e: MapBrowserEvent): void {\r\n                map!.forEachFeatureAtPixel(e.pixel, (feature: Feature | FeatureLike): void => {\r\n                    let castedFeature: Feature = feature as Feature;\r\n                    prevSelected.unshift(castedFeature)\r\n                    setSelectedFeature(prevSelected[0]);\r\n                    prevSelected[0].set('selected', true);\r\n                    if (prevSelected.length > 1) {\r\n                        prevSelected[1].set('selected', false);\r\n                    }\r\n                    prevSelected.splice(1)\r\n                });\r\n            });\r\n            mapListeners.push(mapListener);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Sidebar\r\n                id='sidebar'\r\n                collapsed={collapsed}\r\n                selected={selected}\r\n                onClose={onClose}\r\n                //@ts-ignore\r\n                doOpen={onOpen}\r\n            >\r\n                <Tab\r\n                    id='home'\r\n                    header='Home'\r\n                    faIcon='fa fa-bars'\r\n                >\r\n                    <TabContent\r\n                        content={<p>This is Home.</p>}\r\n                    />\r\n                </Tab>\r\n                <Tab\r\n                    id='database'\r\n                    header='Database'\r\n                    faIcon='fa fa-database'\r\n                />\r\n                <Tab\r\n                    id='locations'\r\n                    header='Set visited locations'\r\n                    faIcon='fa fa-mouse-pointer'\r\n                >\r\n                    <TabContent content={\r\n                        <>\r\n                            <ToggleButton\r\n                                id='toggleVisited'\r\n                                isOn={selectedFeature.get('visited')}\r\n                                isOnColor={activeToggleColor}\r\n                                handleToggle={onToggleChange}\r\n                            />\r\n                            {\r\n                                JSON.stringify(selectedFeature.get('visited'))\r\n                            }\r\n                            <Button\r\n                                buttonText='Update'\r\n                                response='test'\r\n                                clickButton={saveData}\r\n                            />\r\n                        </>\r\n                    } />\r\n                </Tab>\r\n                <Tab\r\n                    id='tracking'\r\n                    header='Tracking'\r\n                    faIcon='fa fa-map'\r\n                >\r\n                    <TabContent content={\r\n                        <>\r\n                            <Button\r\n                                buttonText='Start tracking'\r\n                            />\r\n                            <Button\r\n                                buttonText='Quit tracking'\r\n                            />\r\n                        </>\r\n                    } />\r\n                </Tab>\r\n                <Tab\r\n                    id='settings'\r\n                    header='Settings'\r\n                    faIcon='fa fa-cogs'\r\n                    disabled={true}\r\n                    anchor='bottom' />\r\n                <Tab\r\n                    id='off'\r\n                    header='PowerOff'\r\n                    faIcon='fa fa-power-off'\r\n                    anchor='bottom' />\r\n            </Sidebar>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default MapSidebar;"]},"metadata":{},"sourceType":"module"}